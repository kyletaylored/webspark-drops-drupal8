---
api_version: 1

# PHP Version:
# https://pantheon.io/docs/pantheon-yml#php-version
# Set site's PHP version to 7.0
php_version: 7.2

# Drush Version
# https://pantheon.io/docs/pantheon-yml/#drush-version
drush_version: 8

# Nested Docroot
# https://pantheon.io/docs/pantheon-yml#nested-docroot
web_docroot: true

# Quicksilver Platform Integration Hooks
# https://pantheon.io/docs/pantheon-yml#quicksilver
workflows:
  # Site Creation
  deploy_product:
    after:
      - type: webphp
        description: Post to Slack after site creation
        script: private/scripts/slack_notification.php

  # Multidev Creation
  create_cloud_development_environment:
    after:
      - type: webphp
        description: Post to Slack after Multidev creation
        script: private/scripts/slack_notification.php

  # Commits
  sync_code:
    after:
      - type: webphp
        description: Post to Slack after each code pushed
        script: private/scripts/slack_notification.php

  # Database Clones
  clone_database:
    before:
      - type: webphp
        description: Post to Slack before cloning the database
        script: private/scripts/slack_notification.php
    after:
      - type: webphp
        description: generate development article content after the database clones
        script: private/scripts/generate_dev_content.php
      - type: webphp
        description: Post to Slack after the database clones
        script: private/scripts/slack_notification.php

  # Code Deploys: Notify, Sanitize (if on test), Post to new relic, update db, and notify completion
  deploy:
    before:
      - type: webphp
        description: Post to Slack before cloning the database
        script: private/scripts/slack_notification.php
      - type: webphp
        description: Debugging
        script: private/scripts/debug.php
    after:
      - type: webphp
        description: Post to Slack after each deploy
        script: private/scripts/slack_notification.php

  # Cache Clears: Post to Slack after clearing cache
  clear_cache:
    after:
      - type: webphp
        description: Post to Slack after cache clear
        script: private/scripts/slack_notification.php
